cve_identifier: CVE-2022-32224
snyk_identifiers:
  - SNYK-RUBY-ACTIVERECORD-2960802
ghsa_identifier: GHSA-3hhc-qp5v-9p2j
short_description: Remote code execution in ActiveRecord
unaffected_versions:
  - '~> 6.1.7.18'
affected_versions:
  - '>= 2.3.18.14, <= 2.3.18.43'
  - '>= 3.2.21.1, <= 3.2.22.29'
  - '>= 4.2.10.0, <= 4.2.11.23'
  - '>= 5.2.6.10, <= 5.2.8.10'
patched:
  - versions:
      - '~> 2.3.18.44'
    patch_note: Merged upstream bug fix for Psych >= 2.0 (which requires Ruby >= 1.9) for possible RCE escalation bug with Serialized Columns in Active Record. We tried to make it less of a breaking change than the official patch by adding a default set of permitted serializable classes. Note this patch has no effect for Rubies < 2.1, see https://makandracards.com/railslts/521762-change-to-activerecord-deserialization-cve-2022-32224 for more details.
    requires_intervention: true
  - versions:
      - '~> 3.2.22.30'
    patch_note: Merged upstream bug fix for Psych >= 2.0 (which requires Ruby >= 1.9) for possible RCE escalation bug with Serialized Columns in Active Record. We tried to make it less of a breaking change than the official patch by adding a default set of permitted serializable classes. NOTE THIS PATCH HAS NO EFFECT FOR RUBIES < 2.1, see https://makandracards.com/railslts/521762-change-to-activerecord-deserialization-cve-2022-32224 for more details.
    requires_intervention: true
  - versions:
      - '~> 4.2.11.24'
    patch_note: Backported fix for possible RCE escalation bug with Serialized Columns in Active Record. We tried to make it less of a breaking change than the official patch by adding a default set of permitted serializable classes. See https://makandracards.com/railslts/521762-change-to-activerecord-deserialization-cve-2022-32224 for more details.
    requires_intervention: false
  - versions:
      - '~> 5.2.8.11'
    patch_note: Backported fix for possible RCE escalation bug with Serialized Columns in Active Record. We tried to make it less of a breaking change than the official patch by adding a default set of permitted serializable classes. See https://makandracards.com/railslts/521762-change-to-activerecord-deserialization-cve-2022-32224 for more details.
    requires_intervention: false
